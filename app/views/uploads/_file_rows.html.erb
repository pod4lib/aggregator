<% if can?(:read, upload) && upload.url.present? && upload.files.none? %>
  <tr>
    <td class="text-center"><i class="bi bi-arrow-repeat pod-icon"></i></td>
    <td>
      <i>Downloading...</i>
    </td>
    <td><%= local_time(upload.created_at, format: datetime_display_format()) %></td>
    <td class="text-end">-</td>
    <td>-</td>
    <td class="text-end">-</td>
    <td><%= link_to 'Source ðŸ”—', upload.url, title: upload.url %></td>
  </tr>
<% end %>
<% if upload.status == 'compacted' %>
  <tr>
    <td class="align-middle text-center">
      <i class="<%= Settings.metadata_status.unknown.icon_class %> pod-metadata-status" aria-label=""></i>
    </td>
    <td class="align-middle"><strong>Compacted uploads:</strong></td>
    <td class="align-middle"><%= local_time(upload.created_at, format: datetime_display_format()) %></td>
    <td class="align-middle text-end">-</td>
    <td class="align-middle">-</td>
    <td class="align-middle text-end">-</td>
    <td></td>
  </tr>
  <% upload.compacted_uploads.each do |u| %>
    <%= render 'uploads/file_rows', upload: u %>
  <% end %>
<% end %>
<% upload.files.each do |file| %>
  <tr>
    <td class="align-middle text-center">
      <% status = file.pod_metadata_status %>
      <i class="<%= Settings.metadata_status[status].icon_class %> pod-metadata-status <%= status %>" aria-label="<%= Settings.metadata_status[status].label  %>"></i>
    </td> 
    <td class="align-middle">
      <%= link_to_if can?(:read, upload), file.filename, download_url(file), title: "Download #{file.filename}" %>
    </td>
    <td class="align-middle"><%= local_time(file.created_at, format: datetime_display_format()) %></td>
    <td class="align-middle text-end"><%= number_to_human_size file.byte_size %></td>
    <td class="align-middle"><%= file.content_type %></td>
    <td class="align-middle text-end"><%= file.metadata['count'] ? number_with_delimiter(file.metadata['count']) : '-' %></td>
    <td class="align-middle text-center">
      <% if can? :read, upload %>
        <%= link_to file_info_organization_upload_path(@organization, upload, file), class: 'btn btn-sm btn-secondary' do %>
          <i class="bi bi-search pod-icon" aria-label="Profile"></i>
        <% end %>
        <% if upload.url.present? %>
          <%= link_to 'Source ðŸ”—', upload.url, title: upload.url, class: 'btn btn-sm btn-link' %>
        <% end %>
      <% end %>
    </td>
  </tr>
<% end %>
